<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:t="http://www.tei-c.org/ns/1.0" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><title>Re-processing Abbyy outputs</title><meta name="generator" content="Generated by TEISLIDY stylesheet"></meta><script src="https://www.w3.org/Talks/Tools/Slidy/slidy.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" media="screen, projection" href="https://www.w3.org/Talks/Tools/Slidy/show.css"></link><link href="../css/egXMLhandling.css" rel="stylesheet" type="text/css"></link><link href="../css/tei.css" rel="stylesheet" type="text/css"></link></head><body class="simple" id="TOP"><div class="slide cover"><img src="media/logo.png" width="40%" style="float:left" alt="[Put logo here]" class="cover"></img><br clear="all"></br><h1>Re-processing Abbyy outputs</h1><p>Lou Burnard Consulting</p></div><div class="slide"><h2>Choosing your text</h2><p>Please begin by selecting a text you would like to work on, in a language which you are comfortable with handling. The following items are available in your Work/Novels folder: </p><div class="table"><table><thead><tr class="label"><th rowspan="1" colspan="1" class="data">Identifier</th><th rowspan="1" colspan="1" class="data">Title</th><th rowspan="1" colspan="1" class="data">PDF filename</th><th rowspan="1" colspan="1" class="data">Other formats</th><th rowspan="1" colspan="1" class="data">Wordcount</th></tr></thead><tbody><tr class="data"><td rowspan="1" colspan="1" class="data">ENG18410</td><td rowspan="1" colspan="1" class="data">Cecil, or, The adventures of a coxcomb</td><td rowspan="1" colspan="1" class="data">ENG18410_Gore.pdf</td><td rowspan="1" colspan="1" class="data">ENG18410_Gore.abbyy.xml</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">ENG18470</td><td rowspan="1" colspan="1" class="data">The Castle of Ehrenstein</td><td rowspan="1" colspan="1" class="data">ENG18470_James.pdf</td><td rowspan="1" colspan="1" class="data">ENG18470_James.abbyy.xml</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">ENG19150</td><td rowspan="1" colspan="1" class="data">Pointed Roofs</td><td rowspan="1" colspan="1" class="data">ENG19150_Richardson.pdf</td><td rowspan="1" colspan="1" class="data">ENG19150_Richardson.abbyy.xml, ENG19150_Richardson.docx</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">FRA19120</td><td rowspan="1" colspan="1" class="data">Vers le pole en aeroplane</td><td rowspan="1" colspan="1" class="data">FRA19120_Gilbert.pdf</td><td rowspan="1" colspan="1" class="data">FRA19120_Gilbert.abbyy.xml, FRA19120_Gilbert.docx</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">HUN18460</td><td rowspan="1" colspan="1" class="data">Meghasonlott Kedely</td><td rowspan="1" colspan="1" class="data">HUN18460_Kelmenfy.pdf</td><td rowspan="1" colspan="1" class="data">HUN18460_Kelmenfy.abbyy.xml, HUN18460_Kelmenfy.docx</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">HUN19090</td><td rowspan="1" colspan="1" class="data">Végzetes Tévedésh</td><td rowspan="1" colspan="1" class="data">-</td><td rowspan="1" colspan="1" class="data">HUN19090_Beniczkyne.docx</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">HUN19180</td><td rowspan="1" colspan="1" class="data">A három galamb</td><td rowspan="1" colspan="1" class="data">-</td><td rowspan="1" colspan="1" class="data">HUN19180_Kehel.html</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">ROM18860</td><td rowspan="1" colspan="1" class="data">Teodorei: copila domnului din bucuresti</td><td rowspan="1" colspan="1" class="data">ROM18860_Macri.pdf</td><td rowspan="1" colspan="1" class="data">ROM18860_Macri.abbyy.xml, ROM18860_Macri.docx</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">ROM19060</td><td rowspan="1" colspan="1" class="data">Mara</td><td rowspan="1" colspan="1" class="data">ROM19060_Slavici.pdf</td><td rowspan="1" colspan="1" class="data">ROM19060_Slavici.abbyy.xml, ROM19060_Slavici.docx</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">ROM19170</td><td rowspan="1" colspan="1" class="data">Domnul Badina</td><td rowspan="1" colspan="1" class="data">ROM19170_Smara.pdf</td><td rowspan="1" colspan="1" class="data">ROM19170_Smara.abbyy.xml</td></tr><tr class="data"><td rowspan="1" colspan="1" class="data">SRP18860</td><td rowspan="1" colspan="1" class="data">Omer Čelebija</td><td rowspan="1" colspan="1" class="data">SRP18860_Milicevic.pdf</td><td rowspan="1" colspan="1" class="data">SRP18860_Milicevic.abbyy.xml</td></tr></tbody></table></div><p>Each file with extension .pdf contains a digitized representation of an original printed source, which has been processed by Abbyy OCR. Take a look at this to determine what metadata you can extract for use in the header of your file, and also to familiarize yourself with the basic structure of the text -- whether it has prefaces etc. </p><p>Use online resources (WorldCat, Wikipedia, etc.) to collect other required metadata, such as the full name of the author, their dates, sex, etc. When you have this information, proceed to create a new document and a TEI Header The procedure to follow is described in detail in the <a class="link_ref" href="tutorial-hdr.html">Header Tutorial</a>.</p></div><div class="slide"><h2>Reprocessing abbyy XML format</h2><p>Each file with extension .abbyy.xml contains an XML representation of the results of the OCR procedure carried out by Abbyy. This representation is quite verbose and contains much information we don't need, but it is easy to translate it to a basic TEI form using an XSLT stylesheet. We won't be teaching you XSLT (a standard language for converting one XML document to another) but we have provided a suitable stylesheet for this task. In oXygen, the easiest way to use it is to use a named <span class="q">‘transformation scenario’</span>. We have created such a scenario for you: to use it,</p><ul><li class="item">Open the abby.xml file of your choice in oXygen</li><li class="item">With this file open in the editor, click the big red triangle icon on the toolbar, type CTRL-SHIFT-T, or select Document -&gt; Transformation -&gt; Apply Transformation Scenario from the menu</li><li class="item">If you have set a default transformation, it will be applied; if not the <span class="ident">Transform with</span> dialog box appears. Select the <span class="ident">abby2tei</span> transformation to associate it and then click the <span class="ident">Apply Associated</span> button.</li><li class="item">After a brief delay, you should see a much less richly tagged version of the text.</li></ul><p>Comparing this version with the PDF file you opened earlier, you can see that the tag <span class="gi">&lt;pb/&gt;</span> indicates the start of a new page in the original. Each line of the output corresponds with a typographic line in the source. Blocks of text are tagged with a <span class="gi">&lt;p&gt;</span> element, though not all of them are paragraphs. Where there was a non-textual image in the original, the <span class="gi">&lt;gap&gt;</span> element appears. And of course there are probably quite a few character recognition errors, especially if the original printed text was unclear or damaged.</p><p>There is no automatically generated tagging beyond this; we will therefore have to add it by hand. Refresh your memory about the basic structure of an ELTeC-0 text: any front matter, such as the titlepage or a preface, should be wrapped in a <span class="gi">&lt;front&gt;</span>, while the text itself should be contained by a <span class="gi">&lt;body&gt;</span> element, grouping containing <span class="gi">&lt;div&gt;</span> elements.</p><p>It's up to you how you do this. Here's a suggestion:</p><ul><li class="item">Type CTRL-A to select the whole text</li><li class="item">Type CTRL-E and surround the whole text with a <span class="gi">&lt;text&gt;</span> element.</li><li class="item">If you have front matter: <ul><li class="item">insert a <span class="gi">&lt;front&gt;</span> element at the start of your <span class="gi">&lt;text&gt;</span></li><li class="item">Select the paragraphs making up the titlepage, correct them, and wrap them in a <span class="gi">&lt;div type="titlepage"&gt;</span> inside the <span class="gi">&lt;front&gt;</span></li><li class="item">Decide whether any other prefatory matter is authorial: if it is, wrap it in a <span class="gi">&lt;div type="liminal"&gt;</span>, also inside the <span class="gi">&lt;front&gt;</span>. If it isn't, remove it.</li></ul></li><li class="item">Add a <span class="gi">&lt;body&gt;</span> element to contain the body of the text, and within it at least one <span class="gi">&lt;div type="chapter"&gt;</span></li></ul><p>Your next challenge is to identify the chapter divisions. You may be able to detect them using a regexp to search for specific words, as in the Polish texts, but this is not guaranteed. A text may not have any chapter divisions at all, in which case our schema requires you to wrap the whole thing in one <span class="gi">&lt;div
                        type="chapter"&gt;</span>. Or they may not have been correctly identified by the OCR, in which case you may have to split the current <span class="gi">&lt;div&gt;</span> element at the right place, using ALT-SHIFT-D for example. Use the Outline view (Document-&gt;Show View-&gt;Outline) to see the emerging structure of your document.</p><p>At some point you will want to tidy up the text a little: some things that would be easy to fix are: </p><ul><li class="item">end-of-line hyphenation (where a word is broken across a line) is indicated by the special character <code>¬</code>. This makes it easy to join words up again: use a regexp to remove all occurrences of <code>¬\n</code></li><li class="item">The <span class="gi">&lt;pb/&gt;</span> tag is followed by any running header or page number in the original source, tagged as a separate <span class="gi">&lt;p&gt;</span> element. You may think it worth writing another regexp to remove paragraphs containing only digits and spaces or uppercase letters to catch these, though be careful you don't remove real parts of the text.</li><li class="item">You may catch some recurrent OCR errors using the spell checker built into oXygen (remember to set the correct language : you may need to copy the appropriate spelling files from your Work/Spell directory to ~/.com.oxygenxml/spell)</li></ul><p>When you're reasonably happy with the transcription, type CTRL-A to select all of it and CTRL-C to copy it. Then return to the file in which you prepared your header, move the cursor to the appropriate point inside the <span class="gi">&lt;text&gt;</span> element, and type CTRL-V to paste it. Is the completed document valid? If not, fix it!</p></div><div class="slide"><h2>Reprocessing docx files</h2><p>Abbyy also has the useful capability to export its results in Word DOCX format. Here's a quick guide to converting this to TEI: </p><ul><li class="item">In oXygen, use the usual Open dialog to select the docx file</li><li class="item">A window labelled <span class="ident">Archive Browser</span> opens to the left of the main screen. It shows the file structure of the docx archive.</li><li class="item">Click the blue key next to the folder called <span class="ident">word </span> to see the contents of this folder</li><li class="item">Select the file called <span class="ident">document.xml</span> and double click to open it (may take a few moments if the file is large)</li></ul><p> As you see, this is an XML document, with lots of XML tags, using many different namespaces, most of them defined by Microsoft. </p><ul><li class="item">With the <span class="ident">document.xml</span> file open in your main editing window, select <span class="ident">Transformation -&gt; Configure Transformation Scenario(s)</span> from the <span class="ident">Document</span> menu. Or type <code>CTRL-SHIFT-C</code>. Or click the little spanner icon</li><li class="item">For the default DOCX to TEI conversion, check the little box next to DOCX TEI P5 and press the <span class="ident">Apply Associated</span> button</li><li class="item">A new window opens at the bottom of the screen in which oXygen displays messages relating to the conversion process ; you may safely ignore these. </li><li class="item">In the main editing window, you should now see a TEI-conformant document. (Choose Source &gt; Indenter le document from the Document menu, or type CTRL-MAJ-P or click the Indent button (this one: <img src="media/indent.png" alt="" class="graphic" style=" height:7mm;"></img>) if it is displayed as a single line on the screen) Scroll down to see how the Word styles have been converted.</li><li class="item">Note that many of the paragraphs have a <span class="att">rend</span> attribute. The values of this attribute correspond with the Word style used in the original docx file. We could use these values to make a more intelligent conversion.</li></ul><p>We will begin by using oXygen's built in xPath browser to investigate the tagging more closely. </p><ul><li class="item">Type <code>//p</code> into the <span class="ident">XPath 2.0</span> box at top left and press return</li><li class="item">Scroll down the list of results which opens below the document editing window </li><li class="item">You can see that most of the <span class="gi">&lt;p&gt;</span> elements have similar attributes, usually specifying that they contain <code>body text</code>, though there are some other formatting values</li><li class="item">Type //p[anchor] into the XPath box and press return again. Abbyy helpfully adds an anchor element at the start of each section of the document </li><li class="item">Up to you to see how other elements are used... for example, try <code>//hi</code> to see the<span class="gi">&lt;hi&gt;</span> elements</li></ul><p>oXygen also provides a useful way of automating changes to the markup without the trouble of writing a stylesheet. We will use it to transform all <span class="gi">&lt;p&gt;</span> elements containing an <span class="gi">&lt;anchor&gt;</span> into <span class="gi">&lt;head&gt;</span> elements. </p><ul><li class="item">Open the refactoring tool (select Refactoring from the Tools menu) </li><li class="item">Scroll down to the <span class="ident">Elements</span> section; select <span class="ident">rename</span> element</li><li class="item">In the dialogue box which opens, enter <code>//p[anchor]</code> next to <span class="ident">Target elements (XPATH)</span> and <code>&lt;head&gt;</code> next to <span class="ident">New local name</span></li><li class="item">Press the <span class="ident">Finish</span> button: by default the changes are applied throughout the whole file</li><li class="item">Inside your new <span class="gi">&lt;head&gt;</span> elements you probably now have some redundant tags such as <span class="gi">&lt;anchor&gt;</span> or <span class="gi">&lt;hi.&gt;</span>. You can use the Refactoring Tool to get rid of these too: just select <span class="ident">Delete elements</span> rather than <span class="ident">rename elements</span> and repeat.</li></ul><p>We now have <span class="gi">&lt;head&gt;</span> elements identifying the titles of chapters, but no <span class="gi">&lt;div&gt;</span> tags. We suggest using the find and replace command as a simple way of adding these. The search string should be <code>&lt;head</code>, and the replacement string should be <code>&lt;/div&gt;&lt;div&gt;&lt;div&gt;</code>. Test that this works as you expect before applying it to the whole file. When you have applied it, don't forget to scroll up to the beginning of the text and remove the redundant <code>&lt;/div&gt;</code></p><p>You can also use find and replace to get rid of redundant <span class="att">rend</span> values: simply use (for example) <code>rend="Body Text (2)"</code> as search string and nothing as replacement for it.</p><p>You should now be able to work through the file chapter by chapter, comparing it with the original PDF as suggested above. Check that each chapter break has been correctly detected and recorded</p></div></body></html>