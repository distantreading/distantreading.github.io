<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:t="http://www.tei-c.org/ns/1.0" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><title>Handling plain text files</title><meta name="generator" content="Generated by TEISLIDY stylesheet"></meta><script src="https://www.w3.org/Talks/Tools/Slidy/slidy.js" type="text/javascript"></script><link rel="stylesheet" type="text/css" media="screen, projection" href="https://www.w3.org/Talks/Tools/Slidy/show.css"></link><link href="../css/egXMLhandling.css" rel="stylesheet" type="text/css"></link><link href="../css/tei.css" rel="stylesheet" type="text/css"></link></head><body class="simple" id="TOP"><div class="slide cover"><img src="media/logo.png" width="40%" style="float:left" alt="[Put logo here]" class="cover"></img><br clear="all"></br><h1>Handling plain text files</h1><p></p></div><div class="slide"><h2>Quick ELTeC Corpus Building</h2><p>We've found a great resource on the internet: 100 transcribed Polish novels, all ready to be used. Just a few problems: </p><ul><li class="item">No metadata (other than filenames), so we need to build a proper ElTeC header for each one</li><li class="item">No markup of any sort, so we need to identify chapters, headings, and paragraphs automatically if possible</li></ul><p>This tutorial steps you through the process of going from a plain text file to a level-0 encoded ElTeC conformant version. You should be able to carry this out without any knowledge of Polish, though we do have a Polish participant who has kindly agreed to provide advice if you get stuck. </p><p>The complete process looks like this : </p><ul><li class="item">choose the text and assemble metadata about it</li><li class="item">create a new empty ELTeC-0 document</li><li class="item">complete its TEI Header</li><li class="item">insert the text of the corresponding file into the <span class="gi">&lt;body&gt;</span> of the document</li><li class="item">identify chapter divisions and chapter titles</li><li class="item">identify paragraphs</li></ul></div><div class="slide"><h2>choose the text and create a document</h2><p>Take a look at the <span class="ident">POL</span> folder. It contains 18 files we've pre-selected for you, along with a tiny bit of metadata in a file called <span class="ident">titles.txt</span> which supplies you with an identifier, a filename, a wordcount, and a magic incantation (see below) for each title. Choose one to work on (or we'll give you one)!</p><p>Each filename contains the surname of the author, a word from the title, and the date of first publication. You'll need to enter the name and the title in some suitable search engine (Wikipedia, Worldcat ...) to get the metadata necessary to complete your TEI Header, notably the author's full name, dates, and sex, as well as the full title.</p><p>We also know that each text is derived from a digital collection called <span class="titlem">100 Polish Novels</span> transcribed by the Computational Stylistics Group in Krakow, and that it is freely available from their GitHub repository at https://github.com/computationalstylistics/100_polish_novels. We do not however know much about the print sources for these texts: hopefully your researches should throw up some information at least about their first edition in book form. Armed with that additional information for your chosen text, proceed to create a new file and a valid TEI header for the file.</p><p>This process is described in detail in the <a class="link_ref" href="tutorial-hdr.html">Header Tutorial</a>.</p></div><div class="slide"><h2>add some text</h2><p>Now we are ready to add some text to our document. </p><ul><li class="item">put the cursor inside the solitary <span class="gi">&lt;p&gt;</span> contained by the <span class="gi">&lt;body&gt;</span> element.</li><li class="item">select Document-&gt; File -&gt; Insert File from the menu, and navigate to the text file you are planning to convert</li><li class="item">Press Open, and the content of the file is inserted into your document. </li></ul><p>Note that the error message <code>The body of a text must contain at least one chapter</code> is still present. We will need to introduce more markup. We could do this slowly and painfully, one step at a time, but computers are supposed to make it easier to automate tasks which are slow and painful. In the next section, we'll see how you can take advantage of any systematic patterns in the format of a non-marked-up text to introduce explicit XML markup. To do this we'll use the sophisticated Find/Replace tools built into oXygen.</p></div><div class="slide"><h2>identify the chapters and headings</h2><p>To begin, open the <span class="ident">Find/Replace</span> dialogue and make sure that the check box <span class="ident">Regular expression</span> is selected. A <span class="term">regular expression</span> is a kind of pattern: the find and replace command usually searches for specific character strings; when regular expressions are enabled, it can also search for complex patterns of characters.</p><p>For example, in some of our Polish texts, every new chapter begins with a roman number on a line of its own. In other texts the chapter number is preceded by the word <code>Rozdział</code>; in yet others the chapter has a title given in uppercase letters only. We can write regular expressions to cater for all of these possibilities. Without regular expression matching, we could seek lines containing the explicit strings I, II, III, IV etc. But it is much simpler to seek all such lines by means of a regular expression matching any sequence of one or more of the letters I V or X followed by a new line.</p><ul><li class="item">In file POL001 for example, each chapter is prefixed by a line containing an uppercase Roman number, followed by a line containing the chapter title, all in uppercase. We can use this regular expression to find these: <code>\n[IXV]+\n[\s\p{Lu}]+\S\n</code>.</li><li class="item">In file POL007, however, each chapter is prefixed by the word ROZDZIAŁ, followed by one or more spaces, followed by a roman number and a full stop, and a new line. Here's a regular expression which will find these : <code>ROZDZIAŁ\s+[IVX]+\.</code></li><li class="item">In file POL014, chapters always begin with a lines containing a sequence of uppercase letters and spaces. Here's a regular expression which will find them: <code>[\p{Lu}\s]+\n</code></li><li class="item">Of course, in some cases, for example POL004 or POL006, we can't easily identify where new chapters begin, or they may not be marked at all. Where we can however we've included a suggested regular expression in the <span class="ident">titles.txt</span> file (that's what the mysterious incantantion after the word count is)</li></ul><p>The real power of regular expression matching is not just that it enables us to find quickly particular strings in the text. It also allows us to specify replacements for those strings. In our case, wherever we identify something which is the heading of a chapter, we need to tag it as a <span class="gi">&lt;head&gt;</span>, and also show that it begins a new chapter by inserting a <span class="gi">&lt;div
                        type="chapter"&gt;</span> tag, and (to ensure our document remains well-formed XML) preceding it with a <span class="gi">&lt;/div&gt;</span> tag to close the preceding chapter. The syntax for doing this is simple enough: the replacement part of the find/replace dialogue can include numbered references (like this : <code>\1</code>) which are to be expanded by a part of the matched string, specifically the part enclosed in parentheses.</p><p>This is easier to understand with an example. Let's suppose you are working on POL001.</p><ul><li class="item">Open the <span class="ident">Find/Replace</span> dialogue by typing CTRL-F or selecting Find-&gt;Find/Replace from the main menu, and type the incantation <code>\n([IVX]+)\n([\s\p{Lu}]+)\S\n</code> carefully into the Find box. Press the <span class="ident">Find</span> button to check that it is finding what you expect: you should see that the lines <code>I</code> and <code>ALKHADAR</code> have been selected.</li><li class="item">Each time you press Find, oXygen will step through the file selecting any line containing just a sequence of one or more I X V characters followed by a line containing any sequence of uppercase letters. Try it, just to check. When you're satisfied the regexp is working correctly, move the cursor back to the start of the file and find the first chapter again. </li><li class="item">The parentheses in your regexp allow us to pick out the two character strings that have been matched, for use in the replacement value. Type the following into the <span class="ident">Replace With</span> dialogue <code>\n&lt;/div&gt;&lt;div type="chapter"&gt;&lt;head&gt;\1&lt;/head&gt;\n&lt;head&gt;\2&lt;/head&gt;\n</code> Press the Replace button. You should now see something like this at the start of your file: <div id="index.xml-egXML-d30e179" class="pre cdata egXML_valid"><!--This otherwise redundant comment ensures egXMLs format nicely-->&lt;body&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;Michał&nbsp;Bałucki&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRZEBUDZENI
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;div&nbsp;type="chapter"&gt;&lt;head&gt;I&lt;/head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;ALKHADAR&lt;/head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Warszawo!&nbsp;niewolnico!&nbsp;kiedyś&nbsp;....</div></li><li class="item">(The <span class="gi">&lt;/div&gt;</span> is underlined in red since there's no chapter to close here. Never mind, we'll fix that later)</li><li class="item">When you are sure that your regexp is working correctly, press the <span class="ident">Replace to End</span> button to repeat this manoeuvre for the whole of the rest of the file. You should find 23 matches, and the Outline view (Select Window -&gt; Show view -&gt; Outline if this is not open) should show that you now have 23 chapters.</li></ul></div><div class="slide"><h2>identify the paragraphs</h2><p>In this file, every line other than those beginning with a &lt; character now contains a single paragraph. We can use a simple regexp to mark them all up as <span class="gi">&lt;p&gt;</span> elements :</p><ul><li class="item">Type <code>\n([^&lt;].+)</code> into the <span class="ident">Find</span> box, and <code>\n&lt;p&gt;\1&lt;/p&gt;</code> into the <span class="ident">Replace with:</span> box.</li><li class="item">Move the cursor to the start of the file and check that this regexp does what you expect</li><li class="item">Click the <span class="ident">Replace to End</span> button as before. There should be about 1994 matches and your task is almost complete!</li><li class="item">Finally, go back to the start of the document and delete the lines before <span class="gi">&lt;div type="chapter"&gt;</span>, including the redundant <span class="gi">&lt;/div&gt;</span>. Your file is valid!</li></ul><p>Of course, there's still work to be done... we have not tried to deal with the occasional piece of verse, nor have we tried to markup the trailing headings at the end of some divisions, so these are all appearing as spurious <span class="gi">&lt;p&gt;</span> elements. Feel free to continue perfecting this text -- or maybe you'd rather try a different one? Congratulations on getting this far!</p></div></body></html>